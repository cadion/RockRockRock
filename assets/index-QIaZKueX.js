(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function o(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(t){if(t.ep)return;t.ep=!0;const a=o(t);fetch(t.href,a)}})();function U(){const e=["blue","yellow","orange","purple","white"],s=["rock","paper","scissors"],o=[];for(const i of e)for(const t of s)o.push({color:i,shape:t,id:`${i}-${t}-${Date.now()}-${Math.random()}`});return b(o)}function b(e){const s=[...e];for(let o=s.length-1;o>0;o--){const i=Math.floor(Math.random()*(o+1));[s[o],s[i]]=[s[i],s[o]]}return s}const n={round:1,deck:[],hand:[],discardPile:[],passives:[],currentGimmick:null,currentBoss:null,deckSize:15,enemyCards:[],playerCards:[],selectedHandIndices:[],lostCardsThisRound:0,consecutiveWins:0,lastWinColors:[],phase:"battle",nextRoundModifier:null,reset(){this.round=1,this.deck=U(),this.hand=[],this.discardPile=[],this.passives=[],this.currentGimmick=null,this.currentBoss=null,this.deckSize=15,this.enemyCards=[],this.playerCards=[],this.selectedHandIndices=[],this.lostCardsThisRound=0,this.consecutiveWins=0,this.lastWinColors=[],this.phase="battle",this.nextRoundModifier=null}},g={redMatch:{id:"redMatch",name:"ë¶‰ì€ ì‹¬íŒ",icon:"ğŸ”´",desc:"ë¹¨ê°„ìƒ‰ ì¹´ë“œëŠ” ê°™ì€ ëª¨ì–‘ì¼ ë•Œ ìŠ¹ë¦¬í•©ë‹ˆë‹¤",color:"#e74c3c"},blueMatch:{id:"blueMatch",name:"í‘¸ë¥¸ ì‹¬íŒ",icon:"ğŸ”µ",desc:"íŒŒë€ìƒ‰ ì¹´ë“œëŠ” ê°™ì€ ëª¨ì–‘ì¼ ë•Œ ìŠ¹ë¦¬í•©ë‹ˆë‹¤",color:"#3498db"},thirdReverse:{id:"thirdReverse",name:"ì—­ì „ì˜ ìš©ì‚¬",icon:"ğŸ”„",desc:"ì„¸ ë²ˆì§¸ ì¹´ë“œëŠ” ì§€ëŠ” ëª¨ì–‘ì¼ ë•Œ ìŠ¹ë¦¬í•©ë‹ˆë‹¤",color:"#9b59b6"},redRush:{id:"redRush",name:"ë¹¨ê°„ ë§›",icon:"ğŸ",desc:"í•„ë“œì— ë¹¨ê°„ìƒ‰ ì¹´ë“œê°€ 3ì¥ ì´ìƒì´ë©´ ìŠ¹ì  +1",color:"#c0392b"},flexibility:{id:"flexibility",name:"ìœ ì—°í•¨",icon:"ğŸŒŠ",desc:"ë³´ë¡œ ì´ê¸°ë©´ ë²„ë ¤ì§„ ì¹´ë“œ 1ì¥ ë³µêµ¬",color:"#2980b9"},recycle:{id:"recycle",name:"ì¬í™œìš©",icon:"â™»ï¸",desc:"ë²„ë ¤ì§ˆ í°ìƒ‰ ì¹´ë“œ 1ì¥ì€ ë±ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤",color:"#95a5a6"},joker:{id:"joker",name:"ì¡°ì»¤",icon:"ğŸƒ",desc:"ë³´ë¼ìƒ‰ ì¹´ë“œëŠ” ë¬´ì¡°ê±´ ìŠ¹ë¦¬ (ëª¨ì–‘ ë¬´ì‹œ)",color:"#8e44ad"},bigHand:{id:"bigHand",name:"í° ì†",icon:"ğŸ–ï¸",desc:"í•¸ë“œ í¬ê¸°ê°€ 1 ì¦ê°€í•©ë‹ˆë‹¤ (6ì¥)",color:"#27ae60",handSizeBonus:1},smallDeck:{id:"smallDeck",name:"ì••ì¶•",icon:"ğŸ“¦",desc:"ë± í¬ê¸°ê°€ 1 ê°ì†Œí•©ë‹ˆë‹¤",color:"#e67e22",onApply:e=>{e.deckSize-=1},onRemove:e=>{e.deckSize+=1}}},y={fourCards:{id:"fourCards",name:"4ì—°íƒ€",desc:"ì ì´ íŒ¨ë¥¼ 4ê°œ ëƒ…ë‹ˆë‹¤",enemyCardCount:4},twoCards:{id:"twoCards",name:"ê°€ë²¼ìš´ ì „íˆ¬",desc:"ì ì´ íŒ¨ë¥¼ 2ê°œë§Œ ëƒ…ë‹ˆë‹¤",enemyCardCount:2},greenOnly:{id:"greenOnly",name:"ì´ˆë¡ ì „ì—¼ë³‘",desc:"ì ì´ ì´ˆë¡ìƒ‰ íŒ¨ë§Œ ëƒ…ë‹ˆë‹¤",enemyColor:"green"},scissorsOnly:{id:"scissorsOnly",name:"ê°€ìœ„ ë°”ëŒ",desc:"ì ì´ ê°€ìœ„ë§Œ ëƒ…ë‹ˆë‹¤",enemyShape:"scissors"},fog:{id:"fog",name:"ì•ˆê°œ",desc:"ì ì˜ ê°€ìš´ë° íŒ¨ê°€ ë³´ì´ì§€ ì•ŠìŠµë‹ˆë‹¤",hiddenIndex:1},mimic:{id:"mimic",name:"ëª¨ë°©",desc:"ì ì˜ ì²« ë²ˆì§¸ íŒ¨ê°€ ë‹¹ì‹ ì˜ ì„ íƒì„ ë”°ë¼í•©ë‹ˆë‹¤",mimicFirst:!0},corrosion:{id:"corrosion",name:"ë¶€ì‹",desc:"ì´ë²ˆ ë¼ìš´ë“œ, ë°”ìœ„ëŠ” ê°€ìœ„ì—ê²Œ ì§‘ë‹ˆë‹¤",rockLosesToScissors:!0},overload:{id:"overload",name:"í­ì£¼",desc:"ì ì´ íŒ¨ë¥¼ 5ê°œ ëƒ…ë‹ˆë‹¤! (í•¸ë“œ ì „ë¶€ ì‚¬ìš©)",enemyCardCount:5},reversal:{id:"reversal",name:"ì—­ì „ì˜ ëŒ€ê°€",desc:"í•¸ë“œ ì¹´ë“œëŠ” ë±ìœ¼ë¡œ, í•„ë“œ ì¹´ë“œëŠ” ì†Œë©¸í•©ë‹ˆë‹¤",reversedDiscard:!0},purpleAcquire:{id:"purpleAcquire",name:"ë³´ë¼ìƒ‰ í­í’",desc:"ì¹´ë“œ íšë“ ì‹œ ë³´ë¼ìƒ‰ë§Œ ë“±ì¥í•©ë‹ˆë‹¤",acquireColor:"purple"},scissorsAcquire:{id:"scissorsAcquire",name:"ê°€ìœ„ ì„¸ë¡€",desc:"ì¹´ë“œ íšë“ ì‹œ ê°€ìœ„ë§Œ ë“±ì¥í•©ë‹ˆë‹¤",acquireShape:"scissors"}},M={guardian:{id:"guardian",name:"ìˆ˜í˜¸ì",desc:"6ì¥ì˜ ì¹´ë“œë¡œ ë‹¹ì‹ ì„ ì••ë°•í•©ë‹ˆë‹¤",cardCount:6,bgColor:"#1a0a0a",reward:"rare_passive"},chaos:{id:"chaos",name:"í˜¼ëˆì˜ êµ°ì£¼",desc:"7ì¥ì˜ ì¹´ë“œì™€ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ íŒ¨í„´",cardCount:7,bgColor:"#0a0a1a",reward:"deck_purge"},mirror:{id:"mirror",name:"ê±°ìš¸ì˜ ë§ˆë…€",desc:"ë‹¹ì‹ ì˜ ëª¨ì–‘ì„ ê·¸ëŒ€ë¡œ ë”°ë¼í•©ë‹ˆë‹¤",cardCount:5,mimicAll:!0,bgColor:"#0a1a0a",reward:"rare_passive"},voidLord:{id:"voidLord",name:"ê³µí—ˆì˜ ì¡´ì¬",desc:"ëª¨ë“  ê¸°ë¯¹ì´ ë™ì‹œì— ë°œë™ë©ë‹ˆë‹¤. ìµœì¢… ì‹œë ¨!",cardCount:7,allGimmicks:!0,bgColor:"#0a0010",reward:"victory"}},K={1:{phase:1,enemyCardCount:2,tutorial:!0,passives:[]},2:{phase:1,enemyCardCount:2},3:{phase:1,enemyCardCount:3,passives:["redMatch","blueMatch","bigHand"]},4:{phase:1,enemyCardCount:3},5:{phase:1,enemyCardCount:3,gimmicks:["twoCards"],passives:["smallDeck","recycle"]},6:{phase:1,enemyCardCount:3},7:{phase:1,enemyCardCount:3,gimmicks:["fourCards","fog"],passives:["joker","thirdReverse"]},8:{phase:1,enemyCardCount:3},9:{phase:1,enemyCardCount:3,passives:["redRush","flexibility"]},10:{phase:1,enemyCardCount:3,boss:["guardian"],bossGimmick:"none",passives:["bigHand","smallDeck","joker"]},11:{phase:2,enemyCardCount:3,description:"ì‹œë„ˆì§€ ê°•í™” ì‹œì‘"},12:{phase:2,enemyCardCount:3,gimmicks:["scissorsOnly"],passives:["redMatch","blueMatch"]},13:{phase:2,enemyCardCount:3},14:{phase:2,enemyCardCount:4,gimmicks:["mimic","greenOnly"],passives:["thirdReverse","joker","flexibility"]},15:{phase:2,enemyCardCount:4,passives:["recycle","redRush"]},16:{phase:2,enemyCardCount:4},17:{phase:2,enemyCardCount:4,gimmicks:["corrosion","overload"],passives:["bigHand","smallDeck"]},18:{phase:2,enemyCardCount:4},19:{phase:2,enemyCardCount:4,passives:["joker","flexibility","thirdReverse"]},20:{phase:2,enemyCardCount:4,boss:["chaos"],bossGimmick:"fog",passives:["recycle","bigHand","redRush"]},21:{phase:3,enemyCardCount:4,description:"ê¸°ë¯¹ì˜ ì—­ìŠµ ì‹œì‘"},22:{phase:3,enemyCardCount:4,gimmicks:["reversal"],passives:["smallDeck","recycle"]},23:{phase:3,enemyCardCount:4},24:{phase:3,enemyCardCount:5,gimmicks:["purpleAcquire","scissorsAcquire"],passives:["joker","thirdReverse"]},25:{phase:3,enemyCardCount:5,passives:["flexibility","redMatch","blueMatch"]},26:{phase:3,enemyCardCount:5},27:{phase:3,enemyCardCount:5,gimmicks:["overload","corrosion","fog"],passives:["bigHand","recycle"]},28:{phase:3,enemyCardCount:5},29:{phase:3,enemyCardCount:5,gimmicks:["mimic","reversal"],passives:["joker","redRush","flexibility"]},30:{phase:3,enemyCardCount:5,boss:["mirror"],bossGimmick:"mimic",passives:["thirdReverse","joker","bigHand","smallDeck"]},31:{phase:4,enemyCardCount:5,description:"ìµœì¢… ì‹œë ¨ ì‹œì‘"},32:{phase:4,enemyCardCount:5,gimmicks:["reversal","overload"],passives:["recycle","flexibility"]},33:{phase:4,enemyCardCount:5},34:{phase:4,enemyCardCount:5,gimmicks:["fog","corrosion","mimic"],passives:["bigHand","smallDeck","joker"]},35:{phase:4,enemyCardCount:5,passives:["thirdReverse","redRush","flexibility"]},36:{phase:4,enemyCardCount:5,gimmicks:["purpleAcquire","scissorsAcquire","reversal"]},37:{phase:4,enemyCardCount:5,gimmicks:["overload","fog"],passives:["joker","recycle","bigHand"]},38:{phase:4,enemyCardCount:5},39:{phase:4,enemyCardCount:5,gimmicks:["corrosion","mimic","reversal"],passives:["flexibility","thirdReverse","redMatch","blueMatch"]},40:{phase:4,enemyCardCount:6,boss:["voidLord"],bossGimmick:"allCombined",passives:["joker","bigHand","smallDeck","recycle","flexibility"]}},J={rounds:K},L={rock:"âœŠ",paper:"âœ‹",scissors:"âœŒï¸"};function Q(e=null){const s=n.currentGimmick,o=n.currentBoss,i=n.nextRoundModifier;let t=e?.enemyCardCount||3;o&&o.cardCount?t=o.cardCount:s&&s.enemyCardCount&&(t=s.enemyCardCount),i&&i.enemyCardBonus&&(t=Math.max(2,t+i.enemyCardBonus)),n.nextRoundModifier=null;const a=["rock","paper","scissors"],r=["blue","yellow","orange","purple","white","green"],c=[];for(let d=0;d<t;d++){let m=a[Math.floor(Math.random()*a.length)],p=r[Math.floor(Math.random()*r.length)];s&&s.enemyShape&&(m=s.enemyShape),s&&s.enemyColor&&(p=s.enemyColor);const l=Math.floor(t/2),f=s&&s.hiddenIndex!==void 0&&d===l;c.push({color:p,shape:m,id:`enemy-${d}-${Date.now()}`,hidden:f})}return c}function X(){const e=n.deck;if(e.length===0)return[];const s=n.deckSize,o=n.passives.reduce((c,d)=>c+(d.handSizeBonus||0),0),i=e.length,t=5+o,a=Math.min(Math.max(t,s-(i-t)),i,t);return e.splice(0,a)}function H(e,s){return e===s?0:e==="rock"&&s==="scissors"||e==="paper"&&s==="rock"||e==="scissors"&&s==="paper"?1:-1}function R(e,s,o,i){const t=n.passives,a=n.currentGimmick;if(t.some(c=>c.id==="joker")&&e.color==="purple")return{result:1,reason:"ì¡°ì»¤ ë°œë™!",passiveTriggered:"joker"};if(a&&a.rockLosesToScissors&&e.shape==="rock"&&s.shape==="scissors")return{result:-1,reason:"ë¶€ì‹! ë°”ìœ„ê°€ ë¬´ë ¥í™”ë¨",gimmickTriggered:"corrosion"};if(e.shape===s.shape){if(t.some(c=>c.id==="redMatch")&&e.color==="orange")return{result:1,reason:"ë¶‰ì€ ì‹¬íŒ!",passiveTriggered:"redMatch"};if(t.some(c=>c.id==="blueMatch")&&e.color==="blue")return{result:1,reason:"í‘¸ë¥¸ ì‹¬íŒ!",passiveTriggered:"blueMatch"}}return t.some(c=>c.id==="thirdReverse")&&o===2&&H(e.shape,s.shape)===-1?{result:1,reason:"ì—­ì „!",passiveTriggered:"thirdReverse"}:{result:H(e.shape,s.shape),reason:null}}function Y(){const e=n.playerCards,s=n.enemyCards,o=n.currentGimmick;o&&o.mimicFirst&&e.length>0&&(s[0]={...s[0],shape:e[0].shape,mimicked:!0});let i=0,t=0,a=0;const r=[];for(let f=0;f<s.length;f++){const C=e[f],I=s[f];if(!C){r.push({result:-1,reason:"ì¹´ë“œ ì—†ìŒ"}),t++;continue}const x=R(C,I,f,s.length);r.push(x),x.result===1?i++:x.result===-1?t++:a++}const c=n.passives;let d=0;c.some(f=>f.id==="redRush")&&e.filter(C=>C.color==="orange").length>=3&&(d=1);const m=[];r.forEach((f,C)=>{f.passiveTriggered&&!m.includes(f.passiveTriggered)&&m.push(f.passiveTriggered)}),d>0&&m.push("redRush");const p=i+d,l=p>t;return{results:r,wins:i,losses:t,draws:a,bonusWins:d,totalWins:p,isVictory:l,triggeredPassives:m}}function Z(e){const s=n.passives,o=n.currentGimmick,i=o&&o.reversedDiscard,t=n.hand.filter((r,c)=>!n.selectedHandIndices.includes(c));let a=0;if(i){let r=[...n.playerCards.filter(c=>c!==null)];if(s.some(c=>c.id==="recycle")){const c=r.findIndex(d=>d.color==="white");if(c!==-1){const d=r.splice(c,1)[0];n.deck.push(d)}}n.deck.push(...t),n.discardPile.push(...r),a=r.length}else{let r=[...t];if(s.some(c=>c.id==="recycle")){const c=r.findIndex(d=>d.color==="white");if(c!==-1){const d=r.splice(c,1)[0];n.deck.push(d)}}n.discardPile.push(...r),a=r.length,n.deck.push(...n.playerCards.filter(c=>c!==null))}if(n.deck=b(n.deck),n.hand=[],s.some(r=>r.id==="flexibility")){for(let r=0;r<e.results.length;r++)if(e.results[r].result===1&&n.playerCards[r]?.shape==="paper"){if(n.discardPile.length>0){const c=n.discardPile.pop();n.deck.push(c)}break}}return n.lostCardsThisRound=a,n.playerCards=[],n.selectedHandIndices=[],a}function j(e){const s=n.currentGimmick;let o=["blue","yellow","orange","purple","white"],i=["rock","paper","scissors"];s?.acquireColor&&(o=[s.acquireColor]),s?.acquireShape&&(i=[s.acquireShape]);const t=[];for(let a=0;a<e;a++){const r=o[Math.floor(Math.random()*o.length)],c=i[Math.floor(Math.random()*i.length)];let d=null;const m=Math.random();m<.05?d="cursed":m<.15&&(d="gold"),t.push({color:r,shape:c,id:`acq-${a}-${Date.now()}-${Math.random()}`,special:d})}return t}function ee(){const e=n.deck.length;return e<5?{canContinue:!1,reason:`ë±ì— ì¹´ë“œê°€ ${e}ì¥ë°–ì— ë‚¨ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!`}:{canContinue:!0}}const h=e=>document.querySelector(e),u={roundNum:()=>h("#round-num"),deckCount:()=>h("#deck-count"),gimmickDisplay:()=>h("#gimmick-display"),gimmickText:()=>h("#gimmick-text"),enemyCards:()=>h("#enemy-cards"),playerCards:()=>h("#player-cards"),handCards:()=>h("#hand-cards"),actionBtn:()=>h("#action-btn"),passiveList:()=>h("#passive-list"),battleResult:()=>h("#battle-result"),resultText:()=>h("#result-text"),acquireModal:()=>h("#acquire-modal"),acquireInfo:()=>h("#acquire-info"),acquireCards:()=>h("#acquire-cards"),acquireBtn:()=>h("#acquire-btn"),eventModal:()=>h("#event-modal"),eventPassives:()=>h("#event-passives"),eventSkipBtn:()=>h("#event-skip-btn"),gameoverModal:()=>h("#gameover-modal"),gameoverTitle:()=>h("#gameover-title"),gameoverText:()=>h("#gameover-text"),restartBtn:()=>h("#restart-btn"),gimmickModal:()=>h("#gimmick-modal"),gimmickAnnounceText:()=>h("#gimmick-announce-text"),gimmickOkBtn:()=>h("#gimmick-ok-btn"),deckViewBtn:()=>h("#deck-view-btn"),deckOverlay:()=>h("#deck-overlay"),deckTotalCount:()=>h("#deck-total-count"),deckCardList:()=>h("#deck-card-list"),deckCloseBtn:()=>h("#deck-close-btn"),statRock:()=>h("#stat-rock"),statPaper:()=>h("#stat-paper"),statScissors:()=>h("#stat-scissors"),acquireDeckBtn:()=>h("#acquire-deck-btn"),battleLog:()=>h("#battle-log"),branchModal:()=>h("#branch-modal"),branchOptions:()=>h("#branch-options")};function $(e,s="passive"){const o=u.battleLog(),i=document.createElement("div");i.className=`log-message ${s}`,i.textContent=e,o.appendChild(i),setTimeout(()=>{i.parentNode&&i.remove()},2e3)}const se=[{id:"safe",icon:"ğŸ›¡ï¸",title:"ì•ˆì „í•œ ê¸¸",desc:"ë‹¤ìŒ ë¼ìš´ë“œ ì  ì¹´ë“œ -1, íšë“ ì„ íƒì§€ ê°ì†Œ",type:"safe",modifier:{enemyCardBonus:-1,acquireBonus:-1}},{id:"danger",icon:"âš”ï¸",title:"ìœ„í—˜í•œ ê¸¸",desc:"ë‹¤ìŒ ë¼ìš´ë“œ ì  ì¹´ë“œ +1, íšë“ ì„ íƒì§€ ì¦ê°€",type:"danger",modifier:{enemyCardBonus:1,acquireBonus:2}},{id:"mystery",icon:"ğŸ”®",title:"ì‹ ë¹„ì˜ ê¸¸",desc:"ë¬´ì‘ìœ„ íš¨ê³¼ ì ìš©",type:"mystery",modifier:{mystery:!0}}];function te(e){const s=u.branchModal(),o=u.branchOptions(),t=[...se].sort(()=>Math.random()-.5).slice(0,2);o.innerHTML=t.map(a=>`
        <div class="branch-option ${a.type}" data-id="${a.id}">
            <span class="option-icon">${a.icon}</span>
            <span class="option-title">${a.title}</span>
            <div class="option-desc">${a.desc}</div>
        </div>
    `).join(""),o.querySelectorAll(".branch-option").forEach(a=>{a.addEventListener("click",()=>{const r=t.find(c=>c.id===a.dataset.id);s.classList.add("hidden"),e(r)})}),s.classList.remove("hidden")}function O(){u.roundNum().textContent=n.round;const e=n.deck.length+n.hand.length;u.deckCount().textContent=e}function D(){const e=u.gimmickDisplay(),s=u.gimmickText();n.currentGimmick?(e.classList.remove("hidden"),s.textContent=n.currentGimmick.desc):e.classList.add("hidden")}function w(e,s={}){const{isEnemy:o=!1,isPlaced:i=!1,isSelected:t=!1,showResult:a=!1,result:r=null,index:c=-1,slotNumber:d=null}=s,m=["card",e.color];o&&m.push("enemy-card"),i&&m.push("placed"),t&&m.push("selected"),e.hidden&&m.push("hidden-card"),e.special&&m.push(`special-${e.special}`);let p="";a&&r!==null&&(p=`<div class="result-badge ${r===1?"win":r===-1?"lose":"draw"}">${r===1?"âœ“":r===-1?"âœ—":"âˆ’"}</div>`);let l="";d!==null&&(l=`<div class="slot-badge">${d}</div>`);let f="";e.special==="gold"?f='<div class="special-badge gold">âœ¨</div>':e.special==="cursed"&&(f='<div class="special-badge cursed">ğŸ’€</div>');const C=e.hidden?"?":L[e.shape];return`
    <div class="${m.join(" ")}" data-id="${e.id}" data-index="${c}">
      <span class="shape">${C}</span>
      ${p}
      ${l}
      ${f}
    </div>
  `}function ne(){const e=u.enemyCards();e.innerHTML=n.enemyCards.map((s,o)=>w(s,{isEnemy:!0,index:o})).join("")}function ie(e){const s=u.playerCards(),o=n.enemyCards.length;let i="";for(let t=0;t<o;t++){const a=n.playerCards[t],r=n.enemyCards[t];if(a){let c=null;r&&!r.hidden&&(c=R(a,r,t).result),i+=w(a,{isPlaced:!0,index:t,showResult:c!==null,result:c})}else i+=`<div class="card-slot">${t+1}</div>`}s.innerHTML=i,e&&s.querySelectorAll(".card").forEach(t=>{const a=t.dataset.id;t.addEventListener("click",()=>e(a))})}function oe(e){const s=u.handCards();s.innerHTML=n.hand.map((o,i)=>{const t=n.selectedHandIndices.includes(i);let a=null;if(t){const r=n.playerCards.findIndex(c=>c&&c.id===o.id);r!==-1&&(a=r+1)}return w(o,{isSelected:t,index:i,slotNumber:a})}).join(""),s.querySelectorAll(".card").forEach((o,i)=>{o.addEventListener("click",()=>e(i))})}function ae(){const e=u.handCards(),s=u.playerCards();e.querySelectorAll(".card").forEach((t,a)=>{const r=n.selectedHandIndices.includes(a);r?t.classList.add("selected"):t.classList.remove("selected");let c=t.querySelector(".slot-badge");if(r){const m=n.playerCards.findIndex(p=>p&&p.id===n.hand[a].id)+1;if(c)c.textContent=m;else{const p=document.createElement("div");p.className="slot-badge",p.textContent=m,t.appendChild(p)}}else c&&c.remove()}),s.querySelectorAll(".card-slot, .card").forEach((t,a)=>{const r=n.playerCards[a],c=n.enemyCards[a];if(r){if(t.classList.contains("card-slot")){const d=document.createElement("div");d.className=`card ${r.color} placed`,r.special&&d.classList.add(`special-${r.special}`),d.dataset.id=r.id;let m="";if(c&&!c.hidden){const p=R(r,c,a,n.enemyCards.length),l=p.result===1?"win":p.result===-1?"lose":"draw",f=p.result===1?"âœ“":p.result===-1?"âœ—":"âˆ’";m=`<div class="result-badge ${l}">${f}</div>`}d.innerHTML=`<span class="shape">${L[r.shape]}</span>${m}`,t.replaceWith(d)}}else if(!t.classList.contains("card-slot")){const d=document.createElement("div");d.className="card-slot",d.innerHTML='<span class="slot-num">'+(a+1)+"</span>",t.replaceWith(d)}})}function G(){const e=u.actionBtn(),s=n.enemyCards.length,o=n.playerCards.filter(i=>i!==null).length;o===s?(e.disabled=!1,e.textContent="ì œì¶œí•˜ê¸°!"):(e.disabled=!0,e.textContent=`ì¹´ë“œ ì„ íƒ (${o}/${s})`)}function v(){const e=u.passiveList();if(n.passives.length===0){e.innerHTML='<span style="color: var(--text-secondary); font-size: 12px;">íŒ¨ì‹œë¸Œ ì—†ìŒ</span>';return}e.innerHTML=n.passives.map(s=>`
    <div class="passive-emblem" style="background: ${s.color};">
      ${s.icon}
      <div class="passive-tooltip">${s.name}: ${s.desc}</div>
    </div>
  `).join("")}function re(e,s){const o=u.battleResult(),i=u.resultText(),t=u.playerCards().querySelectorAll(".card"),a=u.enemyCards().querySelectorAll(".card");if(e.results.forEach((c,d)=>{const m=t[d],p=a[d];if(m){const l=c.result===1?"win":c.result===-1?"lose":"draw",f=c.result===1?"âœ“":c.result===-1?"âœ—":"âˆ’";m.insertAdjacentHTML("beforeend",`<div class="result-badge ${l} pop-in">${f}</div>`)}if(p){const l=c.result===1?"lose":c.result===-1?"win":"draw",f=c.result===1?"âœ—":c.result===-1?"âœ“":"âˆ’";p.insertAdjacentHTML("beforeend",`<div class="result-badge ${l} pop-in">${f}</div>`)}}),n.currentGimmick?.mimicFirst&&n.enemyCards[0]?.mimicked){const c=a[0];c&&(c.querySelector(".shape").textContent=L[n.enemyCards[0].shape])}o.classList.remove("hidden","win","lose");let r="";e.isVictory?(o.classList.add("win"),r=`ğŸ‰ ìŠ¹ë¦¬! (${e.totalWins}ìŠ¹ ${e.losses}íŒ¨)`,e.bonusWins>0&&(r+=` [ë¹¨ê°„ ë§› +${e.bonusWins}]`)):(o.classList.add("lose"),r=`ğŸ’€ íŒ¨ë°°... (${e.wins}ìŠ¹ ${e.losses}íŒ¨)`),i.textContent=r,setTimeout(()=>{o.classList.add("hidden"),s()},2e3)}function N(e,s,o){const i=u.acquireModal(),t=u.acquireInfo(),a=u.acquireCards(),r=u.acquireBtn();t.textContent=`${e.length}ì¥ ì¤‘ ${s}ì¥ì„ ì„ íƒí•˜ì„¸ìš”`;let c=[];a.innerHTML=e.map((p,l)=>w(p,{isSelected:!1,index:l})).join(""),a.querySelectorAll(".card").forEach((p,l)=>{p.addEventListener("click",()=>{c.includes(l)?(c=c.filter(f=>f!==l),p.classList.remove("selected")):c.length<s&&(c.push(l),p.classList.add("selected")),r.disabled=c.length!==s})}),r.disabled=!0,i.classList.remove("hidden");const m=()=>{r.removeEventListener("click",m),i.classList.add("hidden");const p=c.map(l=>e[l]);o(p)};r.addEventListener("click",m)}function ce(e,s){const o=u.eventModal(),i=u.eventPassives(),t=u.eventSkipBtn();let a=null;const r=()=>{i.innerHTML=e.map(d=>`
      <div class="passive-choice ${a===d.id?"selected":""}" data-id="${d.id}">
        <span class="icon">${d.icon}</span>
        <span class="name">${d.name}</span>
        <span class="desc">${d.desc}</span>
      </div>
    `).join(""),i.querySelectorAll(".passive-choice").forEach(d=>{d.addEventListener("click",()=>{a=d.dataset.id,r(),c();const m=e.find(p=>p.id===a);s(m)})})},c=()=>{o.classList.add("hidden")};t.onclick=()=>{c(),s(null)},r(),o.classList.remove("hidden")}function de(e,s,o,i){const t=u.eventModal(),a=u.eventPassives(),r=u.eventSkipBtn();r.textContent="ì´ì „ìœ¼ë¡œ",r.style.display="",a.innerHTML=`
    <p style="margin-bottom: 16px;">êµì²´í•  íŒ¨ì‹œë¸Œë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
    <p style="margin-bottom: 16px; font-size: 14px; color: var(--text-secondary);">ìƒˆ íŒ¨ì‹œë¸Œ: ${s.icon} ${s.name}</p>
    ${e.map(c=>`
      <div class="passive-choice" data-id="${c.id}">
        <span class="icon">${c.icon}</span>
        <span class="name">${c.name}</span>
        <span class="desc">${c.desc}</span>
      </div>
    `).join("")}
  `,a.querySelectorAll(".passive-choice").forEach(c=>{c.addEventListener("click",()=>{t.classList.add("hidden"),r.textContent="ê±´ë„ˆë›°ê¸°",o(c.dataset.id)})}),r.onclick=()=>{t.classList.add("hidden"),r.textContent="ê±´ë„ˆë›°ê¸°",i&&i()},t.classList.remove("hidden")}function E(e,s,o){const i=u.gameoverModal(),t=u.gameoverTitle(),a=u.gameoverText(),r=u.restartBtn();t.textContent=e?"ğŸŠ ì¶•í•˜í•©ë‹ˆë‹¤!":"ğŸ’€ ê²Œì„ ì˜¤ë²„",t.style.color=e?"var(--success)":"var(--danger)",a.textContent=s,i.classList.remove("hidden"),r.onclick=()=>{i.classList.add("hidden"),o()}}function le(e,s){const o=u.gimmickModal(),i=u.gimmickAnnounceText(),t=u.gimmickOkBtn();i.textContent=e.desc,o.classList.remove("hidden"),t.onclick=()=>{o.classList.add("hidden"),s()}}function A(){const e=u.deckOverlay(),s=u.deckTotalCount(),o=u.deckCardList(),i=n.discardPile.map(l=>l.id),t=[...n.deck,...n.hand].filter(l=>!i.includes(l.id)),a=n.hand.map(l=>l.id);s.textContent=t.length;const r=["blue","yellow","orange","purple","white"],c=["rock","paper","scissors"];t.sort((l,f)=>{const C=r.indexOf(l.color)-r.indexOf(f.color);return C!==0?C:c.indexOf(l.shape)-c.indexOf(f.shape)}),o.innerHTML=t.map(l=>{const f=a.includes(l.id),C=["card",l.color];return f&&C.push("in-hand"),`
            <div class="${C.join(" ")}" data-id="${l.id}">
                <span class="shape">${L[l.shape]}</span>
            </div>
        `}).join("");const d=t.filter(l=>l.shape==="rock").length,m=t.filter(l=>l.shape==="paper").length,p=t.filter(l=>l.shape==="scissors").length;u.statRock().textContent=d,u.statPaper().textContent=m,u.statScissors().textContent=p,e.classList.remove("hidden")}function P(){u.deckOverlay().classList.add("hidden")}function ue(e){return new Promise(s=>{const i=u.handCards().querySelectorAll(".card");let t=0,a=0;i.forEach((r,c)=>{e.includes(c)||(a++,setTimeout(()=>{r.classList.add("burning"),me(r),t++,t===a&&setTimeout(s,800)},c*100))}),a===0&&s()})}function me(e){const s=e.getBoundingClientRect(),o=e.parentElement;for(let i=0;i<8;i++){const t=document.createElement("div");t.className="ash-particle",t.style.left=`${s.left-o.getBoundingClientRect().left+Math.random()*60}px`,t.style.top=`${s.top-o.getBoundingClientRect().top+40+Math.random()*20}px`,t.style.animationDelay=`${Math.random()*.3}s`,o.appendChild(t),setTimeout(()=>t.remove(),1e3)}}function pe(){return new Promise(e=>{const o=u.playerCards().querySelectorAll(".card"),i=u.deckViewBtn(),t=i.getBoundingClientRect();if(o.length===0){e();return}let a=0;o.forEach((r,c)=>{const d=r.getBoundingClientRect(),m=r.cloneNode(!0);m.style.position="fixed",m.style.left=`${d.left}px`,m.style.top=`${d.top}px`,m.style.width=`${d.width}px`,m.style.height=`${d.height}px`,m.style.margin="0",m.style.zIndex="3000",document.body.appendChild(m),r.style.visibility="hidden",setTimeout(()=>{m.style.transition="all 0.5s cubic-bezier(0.4, 0, 0.2, 1)",m.style.left=`${t.left+t.width/2-30}px`,m.style.top=`${t.top+t.height/2-40}px`,m.style.transform="scale(0.3) rotate(360deg)",m.style.opacity="0",setTimeout(()=>{i.classList.add("absorbing"),setTimeout(()=>i.classList.remove("absorbing"),300)},400),setTimeout(()=>{m.remove(),a++,a===o.length&&e()},500)},c*100)})})}function he(e){return new Promise(s=>{const i=u.handCards().querySelectorAll(".card"),t=u.deckViewBtn(),a=t.getBoundingClientRect();let r=0,c=0;if(i.forEach((d,m)=>{e.includes(m)||c++}),c===0){s();return}i.forEach((d,m)=>{if(!e.includes(m)){const p=d.getBoundingClientRect(),l=d.cloneNode(!0);l.classList.remove("selected"),l.style.position="fixed",l.style.left=`${p.left}px`,l.style.top=`${p.top}px`,l.style.width=`${p.width}px`,l.style.height=`${p.height}px`,l.style.margin="0",l.style.zIndex="3000",l.style.opacity="1",document.body.appendChild(l),d.style.visibility="hidden",setTimeout(()=>{l.style.transition="all 0.5s cubic-bezier(0.4, 0, 0.2, 1)",l.style.left=`${a.left+a.width/2-30}px`,l.style.top=`${a.top+a.height/2-40}px`,l.style.transform="scale(0.3) rotate(360deg)",l.style.opacity="0",setTimeout(()=>{t.classList.add("absorbing"),setTimeout(()=>t.classList.remove("absorbing"),300)},400),setTimeout(()=>{l.remove(),r++,r===c&&s()},500)},m*80)}})})}function fe(){return new Promise(e=>{const o=u.playerCards().querySelectorAll(".card");if(o.length===0){e();return}let i=0;o.forEach((t,a)=>{setTimeout(()=>{t.classList.add("burning"),Ce(t),i++,i===o.length&&setTimeout(e,800)},a*100)})})}function Ce(e){const s=e.getBoundingClientRect();for(let o=0;o<8;o++){const i=document.createElement("div");i.className="ash-particle",i.style.position="fixed",i.style.left=`${s.left+Math.random()*s.width}px`,i.style.top=`${s.top+s.height/2+Math.random()*20}px`,i.style.animationDelay=`${Math.random()*.3}s`,document.body.appendChild(i),setTimeout(()=>i.remove(),1e3)}}function B(){n.reset(),z()}function z(){const e=ee();if(!e.canContinue){E(!1,e.reason,B);return}const s=String(n.round),o=J.rounds[s];if(o?.boss){const i=o.boss[Math.floor(Math.random()*o.boss.length)];if(M[i]){n.currentBoss=M[i],n.currentGimmick=null,$(`âš”ï¸ ë³´ìŠ¤ ë“±ì¥: ${M[i].name}!`,"gimmick"),document.body.style.background=M[i].bgColor,k(o);return}}else n.currentBoss=null,document.body.style.background="";if(o?.gimmicks){const i=o.gimmicks[Math.floor(Math.random()*o.gimmicks.length)];i==="CLEAR"?(n.currentGimmick=null,k(o)):y[i]?(n.currentGimmick=y[i],le(n.currentGimmick,()=>{k(o)})):k(o)}else k(o)}function k(e){if(e?.passives&&e.passives.length>0){const s=e.passives,o=n.passives.map(t=>t.id),i=s.filter(t=>g[t]&&!o.includes(t)).map(t=>g[t]);if(i.length>0){const t=b(i).slice(0,2);be(t,()=>{T(e)})}else T(e)}else T(e)}function T(e=null){n.phase="battle",n.hand=X(),n.enemyCards=Q(e);const s=n.enemyCards.length;n.playerCards=new Array(s).fill(null),n.selectedHandIndices=[],O(),D(),ne(),ie(W),oe(ye),v(),G(),u.actionBtn().onclick=ve}function ye(e){const s=n.hand[e];if(s){if(n.selectedHandIndices.includes(e))F(s,e);else{const o=n.playerCards.findIndex(i=>i===null);o!==-1&&(n.selectedHandIndices.push(e),n.playerCards[o]=s)}V()}}function W(e){const s=n.hand.findIndex(i=>i&&i.id===e);if(s===-1)return;const o=n.hand[s];F(o,s),V()}function F(e,s){const o=n.playerCards.findIndex(i=>i&&i.id===e.id);o!==-1&&(n.playerCards[o]=null),n.selectedHandIndices=n.selectedHandIndices.filter(i=>i!==s)}function V(){ae(),ge(),G()}function ge(){u.playerCards().querySelectorAll(".card").forEach(s=>{s.dataset.bound||(s.dataset.bound="true",s.addEventListener("click",()=>W(s.dataset.id)))})}async function ve(){const e=[...n.selectedHandIndices],s=n.currentGimmick,o=s&&s.reversedDiscard;o?await he(e):await ue(e);const i=Y(),t={joker:"ğŸƒ ì¡°ì»¤ ë°œë™!",redMatch:"ğŸ”´ ë¶‰ì€ ì‹¬íŒ ë°œë™!",blueMatch:"ğŸ”µ í‘¸ë¥¸ ì‹¬íŒ ë°œë™!",thirdReverse:"ğŸ”„ ì—­ì „ì˜ ìš©ì‚¬ ë°œë™!",redRush:"ğŸ ë¹¨ê°„ ë§› +1!"};i.triggeredPassives?.forEach((a,r)=>{setTimeout(()=>{t[a]&&$(t[a],"passive")},r*300)}),re(i,async()=>{if(i.isVictory){o?await fe():await pe();const a=Z(i);a>0?ke(a):S()}else E(!1,`${n.round}ë¼ìš´ë“œì—ì„œ íŒ¨ë°°í–ˆìŠµë‹ˆë‹¤.`,B)})}function ke(e){n.phase="acquire";const s=n.deckSize,o=n.deck.length,i=Math.max(0,s-o),t=Math.min(e,i);if(t<=0){q();return}if(t<=4){const a=j(t*2);N(a,t,r=>{n.deck.push(...r),n.deck=b(n.deck),q()})}else _(t)}function _(e){if(e<=0){q();return}const s=Math.min(4,e),o=j(8);N(o,s,i=>{n.deck.push(...i),n.deck=b(n.deck),_(e-s)})}function q(){n.round>=5&&n.round%5===0&&n.round%10!==0?te(e=>{if(e.modifier.mystery){const s=[{enemyCardBonus:-2,acquireBonus:0},{enemyCardBonus:0,acquireBonus:3},{enemyCardBonus:2,acquireBonus:2}];n.nextRoundModifier=s[Math.floor(Math.random()*s.length)],$("ğŸ”® ë¬´ì‘ìœ„ íš¨ê³¼ ì ìš©!","passive")}else n.nextRoundModifier=e.modifier;$(`${e.icon} ${e.title} ì„ íƒ!`,"passive"),S()}):S()}function be(e,s){n.phase="event";const o=()=>{ce(e,i=>{i?n.passives.length>=3?de(n.passives,i,t=>{const a=n.passives.find(r=>r.id===t);a&&a.onRemove&&a.onRemove(n),n.passives=n.passives.filter(r=>r.id!==t),i.onApply&&i.onApply(n),n.passives.push(i),v(),s()},()=>{o()}):(i.onApply&&i.onApply(n),n.passives.push(i),v(),s()):s()})};o()}function S(){if(n.round++,n.round>40){E(!0,"ğŸŠ 40ë¼ìš´ë“œ í´ë¦¬ì–´! ê³µí—ˆë¥¼ ë¬¼ë¦¬ì¹˜ê³  ìŠ¹ë¦¬í–ˆìŠµë‹ˆë‹¤!",B);return}z()}document.addEventListener("DOMContentLoaded",()=>{B(),u.deckViewBtn().addEventListener("click",A),u.deckCloseBtn().addEventListener("click",P),u.acquireDeckBtn().addEventListener("click",A),u.deckOverlay().addEventListener("click",e=>{e.target===u.deckOverlay()&&P()})});window.cheat={state:n,passives:g,gimmicks:y,setGimmick(e){y[e]?(n.currentGimmick=y[e],D(),console.log(`âœ… ê¸°ë¯¹ ì„¤ì •: ${y[e].name}`)):console.log("âŒ ì‚¬ìš© ê°€ëŠ¥í•œ ê¸°ë¯¹:",Object.keys(y).join(", "))},addPassive(e){if(g[e]){if(n.passives.length>=3){console.log("âš ï¸ íŒ¨ì‹œë¸Œê°€ ì´ë¯¸ 3ê°œì…ë‹ˆë‹¤. ë¨¼ì € removePassiveë¡œ ì œê±°í•˜ì„¸ìš”.");return}const s=g[e];s.onApply&&s.onApply(n),n.passives.push(s),v(),console.log(`âœ… íŒ¨ì‹œë¸Œ ì¶”ê°€: ${s.name}`)}else console.log("âŒ ì‚¬ìš© ê°€ëŠ¥í•œ íŒ¨ì‹œë¸Œ:",Object.keys(g).join(", "))},removePassive(e){const s=n.passives.findIndex(o=>o.id===e);if(s!==-1){const o=n.passives.splice(s,1)[0];o.onRemove&&o.onRemove(n),v(),console.log(`âœ… íŒ¨ì‹œë¸Œ ì œê±°: ${o.name}`)}else console.log("âŒ í˜„ì¬ íŒ¨ì‹œë¸Œ:",n.passives.map(o=>o.id).join(", "))},clearPassives(){n.passives=[],v(),console.log("âœ… ëª¨ë“  íŒ¨ì‹œë¸Œ ì œê±°ë¨")},setRound(e){n.round=e,O(),console.log(`âœ… ë¼ìš´ë“œ ì„¤ì •: ${e}`)},help(){console.log(`
ğŸ® ì¹˜íŠ¸ ëª…ë ¹ì–´ ëª©ë¡:

ğŸ“‹ ìƒíƒœ ë³´ê¸°:
  cheat.state              - í˜„ì¬ ê²Œì„ ìƒíƒœ
  cheat.passives           - ëª¨ë“  íŒ¨ì‹œë¸Œ ëª©ë¡
  cheat.gimmicks           - ëª¨ë“  ê¸°ë¯¹ ëª©ë¡

âš¡ ê¸°ë¯¹ ì„¤ì •:
  cheat.setGimmick('reversal')    - ì—­ì „ì˜ ëŒ€ê°€ ê¸°ë¯¹ ì ìš©

ğŸ”® íŒ¨ì‹œë¸Œ ê´€ë¦¬:
  cheat.addPassive('bigHand')     - í° ì† íŒ¨ì‹œë¸Œ ì¶”ê°€
  cheat.removePassive('bigHand')  - í° ì† íŒ¨ì‹œë¸Œ ì œê±°
  cheat.clearPassives()           - ëª¨ë“  íŒ¨ì‹œë¸Œ ì œê±°

ğŸ”¢ ë¼ìš´ë“œ:
  cheat.setRound(10)              - 10ë¼ìš´ë“œë¡œ ì„¤ì •

ğŸ“¦ ì‚¬ìš© ê°€ëŠ¥í•œ ID:
  ê¸°ë¯¹: ${Object.keys(y).join(", ")}
  íŒ¨ì‹œë¸Œ: ${Object.keys(g).join(", ")}
    `)}};console.log("ğŸ® ì¹˜íŠ¸ ì‚¬ìš©ë²•: cheat.help()");
